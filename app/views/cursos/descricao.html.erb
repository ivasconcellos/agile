<div class="card">

  <div class="card-header"><%= @curso.nome %></div>
  
  <div class="text-center">
    <br>
    <% if @usuario_curso.empty? and no_prazo(@curso) %>
      <%= link_to 'Me inscrever neste Curso', {controller: 'usuario_curso', action: 'inscricao_curso'}, class: "btn btn-md btn-success" %>
    <% end %>

  </div>
  
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <ul class="list-group">
        <li class="list-group-item"><b>Descrição:</b> <%= @curso.descricao.to_s.html_safe %></li> 
        <li class="list-group-item"><b>Professor(a) principal:</b> <%= @curso.proprietario.nome %></li>
        <li class="list-group-item"><b>Início do curso:</b> <%= @curso.data_hora_inicio %></li>
        <li class="list-group-item"><b>Término do curso:</b> <%= @curso.data_hora_termino %></li>
        <li class="list-group-item"><b>Carga horária:</b> <%= @curso.carga_horaria %>h</li>
        <li class="list-group-item"><b>Porcentagem aprovação:</b> <%= @curso.porcentagem_aprovacao %>%</li>
        <li class="list-group-item"><b>Público-alvo:</b> <%= @curso.publico_alvo.to_s.html_safe %></li>
        <% if @curso.criterios_participacao %>
          <li class="list-group-item"><b>Critérios de participação:</b> <%= @curso.criterios_participacao.to_s.html_safe %></li>
        <% end %>
        <% if can? :edit, Curso %>
          <li class="list-group-item"><b>Código de acesso:</b> <%= @curso.codigo_acesso %></li>   
          <li class="list-group-item"><b>Ativo:</b> <%= @curso.ativo? ? 'Sim' : 'Não' %></li>
          <li class="list-group-item"><b>Público:</b> <%= @curso.publico? ? 'Sim' : 'Não' %></li>
          <li class="list-group-item"><b>Cadastrado em:</b> <%= @curso.created_at.strftime("%d/%m/%Y - %H:%M:%S") %></li>
          <li class="list-group-item"><b>Atualizado em:</b> <%= @curso.updated_at.strftime("%d/%m/%Y - %H:%M:%S") %></li>  
          <li class="list-group-item"><b>Tema:</b> <%= link_to @curso.tema_curso.nome, @curso.tema_curso %></li>
        <% end %>
        <% if @perfil and @perfil.perfil == 'Aluno' %>
          <li class="list-group-item"><b>Status no Curso:</b> <%= @perfil.status_curso %></li>
          <% if @perfil.status_curso == 'Curso finalizado' %>
            <li class="list-group-item"><b>Aprovado?</b> <%= @perfil.aprovado? ? 'Sim': 'Não' %></li>
          <% end %> 
        <% end %>      
      </ul>
    </div>
  </div>

  <% if @perfil and @perfil.perfil == "Aluno" %>  
    <div class="card-body">
      <div class="row">
        <div class="col-xl-8 col-sm-8 col-md-8 offset-2">
            <div class="card-header">Meu progresso no curso</div>
            <div class="progress">
              <div class="progress-bar bg-danger" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
            </div>
        </div>
      </div>
    </div>
  <% end %>

  <div class="card-footer text-muted">
    <% if @perfil and @perfil.perfil == "Aluno" and @perfil.status_curso == 'Em andamento' %>  
      <%= link_to 'Cancelar inscrição no curso', cancelar_inscricao_path(id: @perfil.id), class: "btn btn-md btn-danger", data: { confirm: 'Deseja realmente cancelar sua Inscrição no Curso?' } %>
    <% end %>
    <% if @perfil and @perfil.perfil == 'Aluno' and @perfil.pode_finalizar_curso %>
      <%= link_to 'Finalizar curso', finalizar_curso_path(id: @perfil.id), class: "btn btn-md btn-success" %>
    <%end %>
    <% if @perfil and @perfil.perfil == 'Aluno' and @perfil.aprovado %>
      <%= link_to 'Gerar Certificado', gerar_certificado_path(format: :pdf), {class: "btn btn-md btn-warning"} %>
    <%end %>
    <% if can? :edit, Curso %>
      <%= link_to 'Atualizar', edit_curso_path(@curso), class: "btn btn-md btn-primary" %>
    <% end %>
    <%= link_to 'Voltar', :back, class: "btn btn-md btn-secondary" %>
  </div>
  
</div>