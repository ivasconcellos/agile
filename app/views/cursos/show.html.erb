<div class="card">

   <% if can? :new, Modulo %>
    <div class="text-center">
      <br>
      <%= link_to 'Cadastrar Módulo do Curso', {controller: 'modulos', action: 'new', curso_id: @current_usuario.curso_atual_id}, class: "btn btn-md btn-primary" %>
    </div>
  <% end %>

  <% if @usuario_curso.empty? %>
    <div class="text-center">
      <br>
      <%= link_to 'Me inscrever neste Curso', {controller: 'usuario_curso', action: 'inscricao_curso'}, class: "btn btn-md btn-success" %>
    </div>
  <% end %>

  <div id="accordion">
    <% @modulos.each_with_index do |modulo, index| %>
    <div class="card">
      <div class="card-header" id="heading<%= index.to_s %>">
        <h5 class="mb-0">
          <button class="btn btn-link modulo" data-toggle="collapse" data-target="#collapse<%= index.to_s %>" aria-expanded="false" aria-controls="collapse<%= index.to_s %>">
            Módulo: <%= modulo.nome %> 
          </button>
          <% if can? :edit, Modulo %>
            <%= link_to '', edit_modulo_path(modulo), class: "fa fa-edit" %>
          <% end %>
          <% if can? :destroy, Modulo %>
            <%= link_to '', modulo, method: :delete, data: { confirm: 'Deseja realmente excluir o Conteúdo?' }, class: "fa fa-trash" %>
          <% end %>
        </h5>
      </div>

      <div id="collapse<%= index.to_s %>" class="collapse" aria-labelledby="heading<%= index.to_s %>" data-parent="#accordion">
        <div class="card-body">
          <div class="row">
            <div class="col-xl-9 col-sm-9 col-md-9">
              <% if modulo.descricao? %>
                <b> Descrição:</b> <%= modulo.descricao %>
              <% end %>
              <%= render partial: "materiais/materiais", locals: {modulo: modulo} %>
            </div>           

            <div class="col-xl-3 col-sm-3 col-md-3">
              <% if can? :new, Material %>
                <div><%= link_to  ' Inserir Link', {controller: 'materiais', action: 'new', modulo_id: modulo.id, tipo: 'Link'}, class: "fa fa-link" %></div>
                <div><%= link_to  ' Inserir Arquivo', {controller: 'materiais', action: 'new', modulo_id: modulo.id, tipo: 'Arquivo'}, class: "fa fa-file" %></div>
                <div><%= link_to  ' Inserir Vídeo', {controller: 'materiais', action: 'new', modulo_id: modulo.id, tipo: 'Vídeo'}, class: "fa fa-video-camera" %></div>
                <div><%= link_to  ' Inserir Texto', {controller: 'materiais', action: 'new', modulo_id: modulo.id, tipo: 'Texto'}, class: "fa fa-text-width" %></div>
                <div><%= link_to  ' Inserir Imagem', {controller: 'materiais', action: 'new', modulo_id: modulo.id, tipo: 'Imagem'}, class: "fa fa-image" %></div>
              <% end %>
            </div>
          </div>

          <div class="row">

            <div class="col-xl-9 col-sm-9 col-md-9">
              <% @tarefas.each do |tarefa| %>
                <%= link_to tarefa.descricao, tarefa, class: "fa fa-tasks text-dark" %>
              <% end %>
            </div>

            <div class="col-xl-3 col-sm-3 col-md-3">
              <% if can? :new, Tarefa %>
                <div><%= link_to  'Inserir Tarefa', {controller: 'tarefas', action: 'new', modulo_id: modulo.id, tipo: 'Link'}, class: "fa fa-tasks" %></div>
              <% end %>
            </div>
            
          </div>
         
        </div>
      </div>
    </div>
    <% end %>
  </div>

</div>